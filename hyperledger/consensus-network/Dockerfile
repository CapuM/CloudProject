FROM hyperledger/composer-rest-server

ARG COMPOSER_CARD
ARG COMPOSER_NAMESPACES
ARG COMPOSER_AUTHENTICATION
ARG COMPOSER_PROVIDERS
ARG COMPOSER_DATASOURCES
ARG COMPOSER_TLS
ARG COMPOSER_TLS_CERTIFICATE
ARG COMPOSER_TLS_KEY

ENV COMPOSER_CARD=${COMPOSER_CARD}
ENV COMPOSER_NAMESPACES=${COMPOSER_NAMESPACES}
ENV COMPOSER_AUTHENTICATION=${COMPOSER_AUTHENTICATION}
ENV COMPOSER_PROVIDERS=${COMPOSER_PROVIDERS}
ENV COMPOSER_DATASOURCES=${COMPOSER_DATASOURCES}
ENV COMPOSER_TLS=${COMPOSER_TLS}
ENV COMPOSER_TLS_CERTIFICATE=${COMPOSER_TLS_CERTIFICATE}
ENV COMPOSER_TLS_KEY=${COMPOSER_TLS_KEY}

RUN npm install --production loopback-connector-mongodb passport-github && \
  npm cache clean --force && \
  ln -s node_modules .node_modules

